var bool_isFullscreen = false;
var myVideoGIF;

window.addEventListener('fullscreenchange', on_FS_Change, false);

function on_FS_Change(evt) {
  if (document.fullscreenElement != null) {
    bool_isFullscreen = true;
  } else {
    bool_isFullscreen = false;
    exit_FullScreen();
  }
}

function go_FullScreen(input) {
  myVideoGIF = document.getElementById(input.parentNode.id);

  if (bool_isFullscreen == true) {
    exit_FullScreen();
    return;
  }

  function openFullscreen(elem) {
    if (elem.requestFullscreen) {
      elem.requestFullscreen();
    } else if (elem.webkitRequestFullscreen) {
      elem.webkitRequestFullscreen();
    } else if (elem.webkitEnterFullscreen) {
      elem.webkitEnterFullscreen();
    } else if (elem.children[0].webkitEnterFullscreen) {
      elem.children[0].webkitEnterFullscreen();
    } else if (elem.msRequestFullscreen) {
      elem.msRequestFullscreen();
    }
  }

  openFullscreen(myVideoGIF);

  // Apply full screen styles to the video element
  const video = myVideoGIF.children[0];
  video.style.width = "100vw";  // 100% viewport width
  video.style.height = "100vh"; // 100% viewport height
  video.style.objectFit = "cover"; // ensures the video covers the screen proportionally

  // Lock screen orientation to landscape if possible
  if (screen.orientation && screen.orientation.lock) {
    screen.orientation.lock('landscape').catch(function (error) {
      console.error("Orientation lock failed: ", error);
    });
  }

  bool_isFullscreen = true;
}

function exit_FullScreen() {
  if (bool_isFullscreen == true) {
    bool_isFullscreen = false;

    if (document.exitFullscreen) {
      document.exitFullscreen()
        .then(() => console.log("Exited fullscreen mode"))
        .catch((err) => console.error(err));
    } else if (document.webkitExitFullscreen) {
      document.webkitExitFullscreen();
    } else if (document.msExitFullscreen) {
      document.msExitFullscreen();
    }

    // Restore video size to its default
    const video = myVideoGIF.children[0];
    video.style.width = "";  // Reset the style
    video.style.height = "";
    video.style.objectFit = "";

    // Unlock screen orientation (back to the default)
    if (screen.orientation && screen.orientation.unlock) {
      screen.orientation.unlock();
    }
  }
}
